<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CaiCai9426 | 关于自动化部署-jenkins</title>
    <meta name="description" content="菲菲Blog,陆续更新中">
    <link rel="icon" href="/logo.png">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/86.styles.1708be3a.css" as="style"><link rel="preload" href="/assets/js/app.fa713eac.js" as="script"><link rel="preload" href="/assets/js/77.f9cdb120.js" as="script"><link rel="prefetch" href="/assets/js/38.8baf7629.js"><link rel="prefetch" href="/assets/js/0.c7a94944.js"><link rel="prefetch" href="/assets/js/1.75bc214a.js"><link rel="prefetch" href="/assets/js/2.4a593960.js"><link rel="prefetch" href="/assets/js/3.f69ab2b6.js"><link rel="prefetch" href="/assets/js/4.b6ef39fa.js"><link rel="prefetch" href="/assets/js/5.91f53b8d.js"><link rel="prefetch" href="/assets/js/6.7ab4526d.js"><link rel="prefetch" href="/assets/js/7.262318e7.js"><link rel="prefetch" href="/assets/js/8.6b00c1b6.js"><link rel="prefetch" href="/assets/js/9.49213d30.js"><link rel="prefetch" href="/assets/js/10.194074c7.js"><link rel="prefetch" href="/assets/js/11.28772604.js"><link rel="prefetch" href="/assets/js/12.473fa971.js"><link rel="prefetch" href="/assets/js/13.e7244ca3.js"><link rel="prefetch" href="/assets/js/14.9f35604a.js"><link rel="prefetch" href="/assets/js/15.92de29ce.js"><link rel="prefetch" href="/assets/js/16.5081d0f4.js"><link rel="prefetch" href="/assets/js/17.8d7bbf3a.js"><link rel="prefetch" href="/assets/js/18.8b379100.js"><link rel="prefetch" href="/assets/js/19.e6213855.js"><link rel="prefetch" href="/assets/js/20.09855c55.js"><link rel="prefetch" href="/assets/js/21.deccda74.js"><link rel="prefetch" href="/assets/js/22.c3da8c3e.js"><link rel="prefetch" href="/assets/js/23.0f2bdda6.js"><link rel="prefetch" href="/assets/js/24.23916d1d.js"><link rel="prefetch" href="/assets/js/25.4a28d9a1.js"><link rel="prefetch" href="/assets/js/26.638f323d.js"><link rel="prefetch" href="/assets/js/27.9104930e.js"><link rel="prefetch" href="/assets/js/28.f4a9d74b.js"><link rel="prefetch" href="/assets/js/29.a4ffc45d.js"><link rel="prefetch" href="/assets/js/30.34c1be94.js"><link rel="prefetch" href="/assets/js/31.fc4459e1.js"><link rel="prefetch" href="/assets/js/32.6fa53274.js"><link rel="prefetch" href="/assets/js/33.d39ccb38.js"><link rel="prefetch" href="/assets/js/34.95667869.js"><link rel="prefetch" href="/assets/js/35.1c9f7cb6.js"><link rel="prefetch" href="/assets/js/36.c527c4dc.js"><link rel="prefetch" href="/assets/js/37.91db206d.js"><link rel="prefetch" href="/assets/js/39.2b9663c2.js"><link rel="prefetch" href="/assets/js/40.4879e3dd.js"><link rel="prefetch" href="/assets/js/41.bd45403e.js"><link rel="prefetch" href="/assets/js/42.bab6410e.js"><link rel="prefetch" href="/assets/js/43.b6bad706.js"><link rel="prefetch" href="/assets/js/44.3ef4ed34.js"><link rel="prefetch" href="/assets/js/45.4eaec123.js"><link rel="prefetch" href="/assets/js/46.89dbff86.js"><link rel="prefetch" href="/assets/js/47.ec3a4eb4.js"><link rel="prefetch" href="/assets/js/48.1483f745.js"><link rel="prefetch" href="/assets/js/49.ed95d1ac.js"><link rel="prefetch" href="/assets/js/50.1969a022.js"><link rel="prefetch" href="/assets/js/51.8ba405ec.js"><link rel="prefetch" href="/assets/js/52.d10260ca.js"><link rel="prefetch" href="/assets/js/53.4521a8db.js"><link rel="prefetch" href="/assets/js/54.9ad871d9.js"><link rel="prefetch" href="/assets/js/55.58623269.js"><link rel="prefetch" href="/assets/js/56.543fae7f.js"><link rel="prefetch" href="/assets/js/57.c5d65fc9.js"><link rel="prefetch" href="/assets/js/58.04c7d745.js"><link rel="prefetch" href="/assets/js/59.b512423b.js"><link rel="prefetch" href="/assets/js/60.320eda07.js"><link rel="prefetch" href="/assets/js/61.5aae5d3f.js"><link rel="prefetch" href="/assets/js/62.9dfe9e13.js"><link rel="prefetch" href="/assets/js/63.25b34838.js"><link rel="prefetch" href="/assets/js/64.d12d5002.js"><link rel="prefetch" href="/assets/js/65.42b15a91.js"><link rel="prefetch" href="/assets/js/66.cfed3a8a.js"><link rel="prefetch" href="/assets/js/67.1a3b15e5.js"><link rel="prefetch" href="/assets/js/68.9868ce12.js"><link rel="prefetch" href="/assets/js/69.2903063c.js"><link rel="prefetch" href="/assets/js/70.9b5ebefd.js"><link rel="prefetch" href="/assets/js/71.4d376bf0.js"><link rel="prefetch" href="/assets/js/72.c26dd68c.js"><link rel="prefetch" href="/assets/js/73.0c199081.js"><link rel="prefetch" href="/assets/js/74.a575f917.js"><link rel="prefetch" href="/assets/js/75.3bb9db7f.js"><link rel="prefetch" href="/assets/js/76.77eed2ca.js"><link rel="prefetch" href="/assets/js/78.81eb4ea8.js"><link rel="prefetch" href="/assets/js/79.bdfedc4c.js"><link rel="prefetch" href="/assets/js/80.80a3c0e7.js"><link rel="prefetch" href="/assets/js/81.1e44050b.js"><link rel="prefetch" href="/assets/js/82.6ac951ca.js"><link rel="prefetch" href="/assets/js/83.9eec4ec5.js"><link rel="prefetch" href="/assets/js/84.43236687.js"><link rel="prefetch" href="/assets/js/85.b06d6363.js">
    <link rel="stylesheet" href="/assets/css/86.styles.1708be3a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      CaiCai9426
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/deploy/jenkins_cicl.html#jenkins" class="nav-link">blog</a></div><div class="nav-item"><a href="/project/" class="nav-link">项目</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/deploy/jenkins_cicl.html#jenkins" class="nav-link">blog</a></div><div class="nav-item"><a href="/project/" class="nav-link">项目</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>vue文档</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>部署</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/deploy/jenkins_cicl.html" class="active sidebar-link">关于自动化部署-jenkins</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deploy/jenkins_cicl.html#jenkins" class="sidebar-link">Jenkins</a></li><li class="sidebar-sub-header"><a href="/deploy/jenkins_cicl.html#jenkins初始化" class="sidebar-link">Jenkins初始化</a></li><li class="sidebar-sub-header"><a href="/deploy/jenkins_cicl.html#git钩子功能" class="sidebar-link">git钩子功能</a></li><li class="sidebar-sub-header"><a href="/deploy/jenkins_cicl.html#实现自动化构建" class="sidebar-link">实现自动化构建</a></li><li class="sidebar-sub-header"><a href="/deploy/jenkins_cicl.html#自动化部署" class="sidebar-link">自动化部署</a></li><li class="sidebar-sub-header"><a href="/deploy/jenkins_cicl.html#如果想把构建好的文件-打包在一起-，然后再再后续的操作中进行解压，可以执行以下操作，然后再解压。" class="sidebar-link">如果想把构建好的文件 打包在一起 ，然后再再后续的操作中进行解压，可以执行以下操作，然后再解压。</a></li><li class="sidebar-sub-header"><a href="/deploy/jenkins_cicl.html#构建后操作" class="sidebar-link">构建后操作</a></li><li class="sidebar-sub-header"><a href="/deploy/jenkins_cicl.html#构建后邮件发送" class="sidebar-link">构建后邮件发送</a></li></ul></li><li><a href="/deploy/nginx.html" class="sidebar-link">Nginx</a></li><li><a href="/deploy/pm2.html" class="sidebar-link">pm2 </a></li><li><a href="/deploy/server_node.html" class="sidebar-link">搭建node.js 生成环境</a></li><li><a href="/deploy/ssh.html" class="sidebar-link">ssh 远程登陆服务器</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>JS文档</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>gulp文档</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>git相关文档</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Webpack</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="关于自动化部署-jenkins"><a href="#关于自动化部署-jenkins" aria-hidden="true" class="header-anchor">#</a> 关于自动化部署-jenkins</h1><p><strong>travis-ci</strong> 只要是 Github 上的开源项目全部免费。
如果你的项目不是开源项目，用Travis Pro就需要交钱了。
如果不想交钱，可以自己搭建CI环境，利用Jenkins CI进行持续集成。</p><p>github
<a href="https://segmentfault.com/a/1190000011218410" target="_blank" rel="noopener noreferrer">Travis CI 系列：自动化部署博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a href="https://zhuanlan.zhihu.com/p/36390666" target="_blank" rel="noopener noreferrer">搭建持续集成、基于vuepress的Github Page --使用travis-ci<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a href="https://www.jianshu.com/p/22b7860b4e81" target="_blank" rel="noopener noreferrer">手把手教你搭建Jenkins+Github持续集成环境<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p><a href="https://www.zhihu.com/question/60194439/answer/236426588" target="_blank" rel="noopener noreferrer">如何实现前端工程的持续集成与持续部署？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p><a href="https://juejin.im/post/5ad1980e6fb9a028c42ea1be" target="_blank" rel="noopener noreferrer">实战笔记：Jenkins打造强大的前端自动化工作流<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><hr><h1 id="使用jenkins-进行前端自动化集成以及部署"><a href="#使用jenkins-进行前端自动化集成以及部署" aria-hidden="true" class="header-anchor">#</a> 使用Jenkins 进行前端自动化集成以及部署</h1><h2 id="jenkins"><a href="#jenkins" aria-hidden="true" class="header-anchor">#</a> Jenkins</h2><h3 id="安装java环境"><a href="#安装java环境" aria-hidden="true" class="header-anchor">#</a> 安装java环境</h3><p>jenkins 运行在java环境下</p><p><a href="http://blog.csdn.net/fenglailea/article/details/26006647" target="_blank" rel="noopener noreferrer">ubuntu 17.x/CentOS 7.x中安装JAVA JDK<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a href="https://www.cnblogs.com/EasonJim/p/7139294.html" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> add-apt-repository ppa:openjdk-r/ppa  
$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update  
$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> openjdk-8-jdk  
</code></pre></div><h3 id="安装-jenkins"><a href="#安装-jenkins" aria-hidden="true" class="header-anchor">#</a> 安装 jenkins</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">wget</span> -q -O - http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key <span class="token operator">|</span> <span class="token function">sudo</span> apt-key add -  
<span class="token function">sudo</span> sh -c <span class="token string">'echo deb http://pkg.jenkins-ci.org/debian binary/ &gt; /etc/apt/sources.list.d/jenkins.list'</span>  
<span class="token function">sudo</span> <span class="token function">apt-get</span> update  
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> jenkins  
</code></pre></div><p><strong>安装文件位置</strong></p><p>安装目录：<code>/var/lib/jenkins</code></p><p>日志目录：<code>/var/log/jenkins/jenkins.log</code></p><p>启动/停止</p><p><code>sudo /etc/init.d/jenkins start</code></p><p><code>sudo /etc/init.d/jenkins stop</code></p><p><strong>访问（当前IP）</strong>
http://192.168.1.100:8080/  阿里云服务器话记得开启网络安全组</p><ul><li>以守护进程启动 Jenkins，详细信息可以参考 /etc/init.d/jenkins</li><li>创建一个 jenkins 用户用以启动服务</li><li>如果 Jenkins 服务异常，可以查看 /var/log/jenkins/jenkins.log 日志文件</li><li>的配置文件为 /etc/default/jenkins，可以配置启动参数，比如 JENKINS_HOME</li><li>Jenkins 启动端口为8080，使用浏览器访问该端口开始配置项目
<strong>如果 /etc/init.d/jenkins 文件启动 Jenkins 服务失败，编辑 /etc/default/jenkins 文件，把 HTTP_PORT=8080 换成你的主机可以使用的端口号即可</strong></li></ul><p><strong>CentOS：修改配置在这</strong><code>sudo vim /etc/sysconfig/jenkins</code></p><p><strong>windows下：</strong>
从Jenkins官网下载最新war文件。
运行java -jar jenkins.war即可。</p><h2 id="jenkins初始化"><a href="#jenkins初始化" aria-hidden="true" class="header-anchor">#</a> Jenkins初始化</h2><ol><li>jenkins的默认端口是8080,启动成功后在浏览器打开。</li><li>进入后会让我们输管理员密码，打开网页上提示路径下的文件，复制密码粘贴输入即可。</li><li>然后按照插件，默认推荐就可以。</li><li>创建一个管理员账户。（记住账号）</li></ol><p>如果在linux，复制默认的密码可是个麻烦事,可以通过<code>cat</code> 命令输出</p><div class="language-bash extra-class"><pre class="language-bash"><code>/var/lib/jenkins/secrets/initialAdminPassword
<span class="token function">sudo</span> <span class="token function">cat</span> /var/lib/jenkins/secrets/initialAdminPassword  可以输出查看
</code></pre></div><ol start="5"><li>创建任务
选择自由风格的软件项目，并起一个名字</li></ol><h2 id="git钩子功能"><a href="#git钩子功能" aria-hidden="true" class="header-anchor">#</a> git钩子功能</h2><p>我们想要的效果是：</p><p>git提交代码到 git仓库时jenkins自动构建，自动部署。</p><p><strong>钩子</strong>需要在远端仓库上进行配置。
Jenkins服务器的接口地址，当本地向远端仓库发起push时，远端仓库会向配置的Jenkins服务器的接口地址发起一个带参数的请求，jenkins收到后开始执行。</p><p>在Jenkins中选择项目， 配置=》代码管理</p><ol><li>输入 git仓库地址。</li><li>git账号名和密码</li><li>选择分支！</li></ol><p><img src="/assets/img/jenkins_01.c7754854.png" alt="jenkins_01.png"></p><p><strong>安装 Generic Webhook Trigger 插件</strong>
在任务配置里勾选Generic Webhook Trigger即可。
触发器插件功能很强大，可以根据不同的触发参数触发不同的构建操作，比如我向远程仓库提交的是master分支的代码，就执行代码部署工作，我向远程仓库提交的是某个feature分支，就执行单元测试，单元测试通过后合并至dev分支。只要有提交就触发。</p><p><strong>设置webhooks</strong>
在git仓库中设置webhooks
码云：
url:<code>http://&lt;User ID&gt;:&lt;API Token&gt;@&lt;Jenkins IP地址&gt;:端口/generic-webhook-trigger/invoke</code></p><p>userid和api token 在jenkins的系统管理-管理用户
Jenkins IP地址和端口是为部署jenkins服务器的ip地址，端口号默认为8080。
密码为jenkins账号 userid对应的密码</p><p><img src="/assets/img/jenkins_2_webhooks.7b23c94f.png" alt="jenkins_2_webhooks"></p><p><strong>测试钩子</strong>
点击test,就可以触发钩子。
jenkins开始执行任务,如果没有配置任务，默认只会在你提交新代码后，将新代码拉取到jenkins服务器上（jenkins的工作环境）。</p><p><img src="/assets/img/jenkins_3_testwebhooks.37fb285d.png" alt="jenkins_3_testwebhooks"></p><h2 id="实现自动化构建"><a href="#实现自动化构建" aria-hidden="true" class="header-anchor">#</a> 实现自动化构建</h2><p>前端的项目离不开 node的环境，所以我们可以通过插件，然jenkins的工作环境自动构建好node环境，来执行我们的构建工作，如webpack,gulp等。
<strong>nvm wrapper</strong> 插件
安装了该插件后，可以在 <strong>jenkins配置</strong> =》<strong>构建环境</strong>=》<strong>勾选</strong>“Run the build in an NVM managed environment”
并输入指定的node.js 版本 如 <code>v9.8.0</code></p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p><strong>nvm wrapper不稳的！！影响构建</strong>。
改用 <strong>NodeJS Plug</strong>吧</p></div><p>安装后 进入 系统管理-&gt;Global Tool Configuration，配置node下载及安装</p><p><img src="/assets/img/jenkins_node.475c428e.png" alt="node"></p><p>回到项目的配置中，找到【构建环境】，勾选Provide Node &amp; npm bin/ folder to PATH</p><p><strong>构建</strong>中添加执行语句</p><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&amp;&amp;</span>
<span class="token function">npm</span> run unit <span class="token operator">&amp;&amp;</span>
<span class="token function">rm</span> -rf dist <span class="token operator">&amp;&amp;</span>
<span class="token function">npm</span> run build
</code></pre></div><p>保存 ，基本配置完成。</p><p>以后向git仓库提交代码，jenkins 就会自动构建好项目。</p><p><img src="/assets/img/jenkins_4ok.cfd4de60.png" alt="jenkins_4ok"></p><p>Finished状态的如果是</p><ul><li>SUCCESS（蓝色）则证明执行的任务都顺利进行。</li><li>FAILURE（红色）则证明中间有重大错误导致任务失败。</li><li>UNSTABLE（黄色）代表有虽然有些小问题，但不阻碍任务进行。</li></ul><p>如果上一步是SUCCESS，点击项目的工作空间，将会发现多了<code>dist</code>和<code>node_modules</code>两个文件夹。</p><h2 id="自动化部署"><a href="#自动化部署" aria-hidden="true" class="header-anchor">#</a> 自动化部署</h2><p>自动构建还不够 还需要自动部署啊</p><p>Jenkins上装一个插件 <strong>Publish Over SSH</strong>，我们将通过这个工具实现服务器部署功能。</p><p>在要部署代码的服务器上创建一个文件夹用于接收Jenkins传过来的代码.
Jenkins往服务器上部署代码必须登录服务器,有两种登录验证方式，
一种是ssh验证，一种是密码验证，</p><p>在 <strong>系统管理</strong> - <strong>Publish over SSH</strong></p><div class="language- extra-class"><pre class="language-text"><code>Passphrase：密码（key的密码，没设置就是空）
Path to key：key文件（私钥）的路径
Key：将私钥复制到这个框中(path to key和key写一个即可)

SSH Servers的配置：
SSH Server Name：标识的名字（随便你取什么）
Hostname：需要连接ssh的主机名或ip地址（建议ip）
Username：用户名
Remote Directory：远程目录（上面第二步建的testjenkins文件夹的路径）

高级配置：
点击 Use password authentication, or use a different key：勾选这个可以使用密码登录，**不想配ssh，也可以用密码登陆**
Passphrase / Password：密码登录模式的密码
Port：端口（默认22）
Timeout (ms)：超时时间（毫秒）默认300000
</code></pre></div><p>点击<code>Test Configuration</code>测试一下是否可以连接上，如果成功会返回success，失败会返回报错信息。</p><p><strong>关于用SSH连接</strong></p><blockquote><p>Username
The user that will be used to connect to the host.
This user will need the <code>public key</code> in their <code>authorized_keys</code> file on the remote host (if using public key authentication).</p></blockquote><p>所以需要 <code>Key</code>选项填写 jenkins挂载的电脑的私钥。
同时修改修改服务器，在authorized_keys 文件添加 public key</p><h2 id="如果想把构建好的文件-打包在一起-，然后再再后续的操作中进行解压，可以执行以下操作，然后再解压。"><a href="#如果想把构建好的文件-打包在一起-，然后再再后续的操作中进行解压，可以执行以下操作，然后再解压。" aria-hidden="true" class="header-anchor">#</a> 如果想把构建好的文件 打包在一起 ，然后再再后续的操作中进行解压，可以执行以下操作，然后再解压。</h2><p>进入 配置 =》 构建
添加</p><div class="language- extra-class"><pre class="language-text"><code>......
......
cd dist&amp;&amp;
tar -zcvf dist.tar.gz *

</code></pre></div><p>注意，因为权限问题，我们只能在现在的工作空间进行操作，离开这个文件夹就没有权限了，所以这里就不会直接把所有操作都放在这里。</p><h2 id="构建后操作"><a href="#构建后操作" aria-hidden="true" class="header-anchor">#</a> 构建后操作</h2><p>点击构建后操作，增加构建后操作步骤，选择send build artificial over SSH。</p><div class="language- extra-class"><pre class="language-text"><code>Name:选择配好的ssh服务器（系统设置的设置好的）
Source files ：写你要传输的文件路径 
Remove prefix ：要去掉的前缀，不写远程服务器的目录结构将和Source files写的一致
Remote directory ：写你要部署在远程服务器的那个目录地址下，不写就是SSH Servers配置里默认远程目录,(在默认配置的基础上)
Exec command ：传输完了要执行的命令，我这里执行了解压缩和解压缩完成后删除压缩包2个命令  (默认路径是在用户根目录下)

</code></pre></div><p>Source files ：<code>dist/dist.tar.gz</code>
Remove prefix ：<code>dist/</code>
Remote directory ： <code></code>
Exec command ：</p><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> testJenkins
<span class="token function">tar</span> -zxvf dist.tar.gz
<span class="token function">rm</span> -rf dist.tar.gz
</code></pre></div><h2 id="构建后邮件发送"><a href="#构建后邮件发送" aria-hidden="true" class="header-anchor">#</a> 构建后邮件发送</h2><p>系统管理-&gt;系统设置</p><ol><li><p><code>Jenkins Location</code>找到<code>系统管理员邮件地址</code>，输入发送邮件的邮箱地址</p></li><li><p>在邮件通知中输入配置</p></li></ol><p><img src="/assets/img/jenkins_5email1.8887cbdb.png" alt="55"></p><p>配置好了之后可以勾选“通过发送测试邮件测试配置”来测试配置是否成功</p><ol start="3"><li>需要更高级的邮件通知功能需要再安装一个Jenkins插件：<strong>Email Extension Plugin</strong></li></ol><ul><li><p>Default Recipients：输入需要发送邮件的接收人邮箱地址，使用英文“,”分割。</p></li><li><p>Default Subject：邮件的主题名
<code>$PROJECT_NAME - $BUILD_STATUS - Build # $BUILD_NUMBER!</code>  （默认）</p></li><li><p>Default Content</p></li></ul><div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>${ENV, var=&quot;JOB_NAME&quot;}-第${BUILD_NUMBER}次构建日志<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>  
  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">leftmargin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span> <span class="token attr-name">marginwidth</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">topmargin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span> <span class="token attr-name">marginheight</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span>  
    <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>95%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cellpadding</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cellspacing</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name">  
        <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">font-size</span><span class="token punctuation">:</span> 11pt<span class="token punctuation">;</span> <span class="token property">font-family</span><span class="token punctuation">:</span> Tahoma, Arial, Helvetica, sans-serif</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#0B610B<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>构建信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>  
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>  
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>项目名称 ： ${PROJECT_NAME}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>构建编号 ： 第${BUILD_NUMBER}次构建<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>SVN 版本： ${SVN_REVISION}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>触发原因： ${CAUSE}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>构建日志： <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${BUILD_URL}console<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>${BUILD_URL}console<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>构建  Url ： <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${BUILD_URL}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>${BUILD_URL}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>工作目录 ： <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${PROJECT_URL}ws<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>${PROJECT_URL}ws<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>项目  Url ： <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${PROJECT_URL}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>${PROJECT_URL}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#0B610B<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>变更集<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>  
          
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>${JELLY_SCRIPT,template=&quot;html&quot;}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>  


  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>$PROJECT_NAME - Build # $BUILD_NUMBER - $BUILD_STATUS:

    Check console output at $BUILD_URL to view the results.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>  
</code></pre></div><ol start="4"><li>在需要发送邮件通知的项目里添加Email配置</li></ol><p><a href="https://blog.csdn.net/songjiaping/article/details/51496977" target="_blank" rel="noopener noreferrer">jenkins构建后邮件发送<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
点击 <strong>增加构建后操作步骤</strong>，选择 <strong>Editable Email Notification</strong></p><p>点击 <strong>advanced Settings</strong>，配置Trigger,选择触发时机，</p><p>一般都选择默认的，但是要注意需要添加 <strong>Triggers</strong>，没有添加Triggers就不会发送通知邮件出来，这是一个触发条件。</p><p>主要添加的Triggers有三类：<code>Failure-Any</code>构建失败，<code>Success</code>构建成功，<code>Unstable (Test Failures)</code>构建不稳定   时触发发送邮件通知。</p><p>然后再选择的Triggers点击高级。</p><p>send to就是指发送给什么人，默认发送给Developers，也就是对这次构建有过修改动作的人，一般会选择Recipient List，就是默认列表中添加的成员邮箱都会被发送通知邮件。</p><p><strong>Recipient List</strong> 可以填写多个邮箱，用<code>,</code>分开。</p></div><div class="content edit-link"><!----><!----></div><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/vue/vue_props.html" class="prev">
          vue 父子组件时间传递
        </a></span><span class="next"><a href="/deploy/nginx.html">
          Nginx
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/77.f9cdb120.js" defer></script><script src="/assets/js/app.fa713eac.js" defer></script>
  </body>
</html>
